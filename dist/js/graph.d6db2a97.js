"use strict";(self["webpackChunknoosphere"]=self["webpackChunknoosphere"]||[]).push([[786],{3447:function(e,t,s){s.r(t),s.d(t,{default:function(){return h}});var r=function(){var e=this,t=e._self._c;return t("b-row",[t("b-col",[t("div",{ref:"graph",attrs:{id:"graph",width:"100px"}},[e._v("Loading graph...")])]),t("b-col",[t("div",[e._v(" "+e._s(e.currentNode)+" "),t("hr"),e._v(" "+e._s(e.uploads)+" "),t("hr")])])],1)},o=[],i={name:"GraphView",data(){return{nodes:[],links:[]}},mounted(){this.$graphInit({domElement:this.$refs.graph}),this.updateUsers()},methods:{update(){if(void 0!=this.graph){let e=this.nodes.map((e=>({...e}))),t=this.links.map((e=>({...e})));this.graph.graphData({nodes:e,links:t}),console.log(this.graph.graphData())}},updateUsers(){for(const[r,o]of Object.entries(this.users)){console.log("[user]",r,o),o.id=o.clientID,o.group="user";var e=this.nodes.findIndex((e=>e.id==o.id));-1===e&&this.nodes.push(o);for(const[e,r]of Object.entries(o.rooms)){r.id=e,r.name=e,r.group="room";var t=this.nodes.findIndex((e=>e.id==r.id));-1===t&&this.nodes.push(r);let i={source:o.id,target:r.id,group:"visited",label:"visited",color:"blue"};r.id==o.roomId&&(i.group="current",i.label="current",i.color="red");var s=this.links.findIndex((e=>e.source==i.source&&e.target==i.target));-1===s?this.links.push(i):Object.assign(this.links[s],i)}}this.update()}},watch:{nodes(){this.update()},links(){this.update()},graph(){this.update()},users(){this.updateUsers()},usersUpdateDate(){console.log(this.usersUpdateDate),this.updateUsers(),this.$forceUpdate()},currentNode(){console.log(this.currentNode);let e=this.$store.state.core.user;switch(this.currentNode.group){case"room":e.roomId=this.currentNode.id,this.$store.commit("core/setUser",e),this.$openRoom();break;case"user":break;default:console.log("i don't know what to do")}}},computed:{graph(){return this.$store.state.network.graph},users:{cache:!1,get(){return this.$store.state.core.users}},usersUpdateDate(){return this.$store.state.core.usersUpdateDate},uploads(){return this.$store.state.core.uploads},currentNode(){return this.$store.state.network.currentNode}}},a=i,n=s(1001),d=(0,n.Z)(a,r,o,!1,null,"72cc1680",null),h=d.exports}}]);
//# sourceMappingURL=graph.d6db2a97.js.map